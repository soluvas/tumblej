h1. TumbleJ Tumblr API Camel Component

URI :

bc. tumblej:<yourblog>.tumblr.com?consumerKey=xxx&consumerSecret=xxx&token=xxx&tokenSecret=xxx

h2. Posting

Default post type is text.
All post types (including Link post) use the exchange message body for primary post content.

Optional headers:

1. tags
2. date

h3. Posting Text

Header: type = text (optional)

h3. Posting Photo

Header: type = photo

h3. Posting Quote

Header: type = quote

Headers:
1. source

h3. Posting Link

Header: type = link

h3. Posting Chat

Header: type = chat

h3. Posting Audio

Header: type = audio

h3. Posting Video

Header: type = video

h2. Deploying to Karaf

h3. Patch Karaf jre.properties

Overwrite @karaf/etc/jre.properties@ using @karaf/etc/jre.properties.cxf@
(see https://issues.apache.org/jira/browse/CAMEL-5434 )

h3. Install camel-core

In Karaf, with features you run:

bc. features:addUrl mvn:org.apache.camel.karaf/apache-camel/2.10.0/xml/features
features:install -v camel-core

Without features: (untested)

bc. install mvn:org.apache.camel/camel-core/2.10.0

h3. Install Jersey dependencies

bc. install mvn:org.codehaus.jettison/jettison/1.3.1
install mvn:org.codehaus.jackson/jackson-core-asl/1.9.8
install mvn:org.codehaus.jackson/jackson-mapper-asl/1.9.8
install mvn:org.codehaus.jackson/jackson-jaxrs/1.9.8

jettison is required by jersey-json
jackson 1.9 is required by jersey-json

h3. Install jersey-core, jersey-json, jersey-client, oauth-signature, oauth-client

bc. install mvn:com.sun.jersey.contribs.jersey-oauth/oauth-client/1.13
install mvn:com.sun.jersey/jersey-core/1.13
install mvn:com.sun.jersey/jersey-json/1.13
install mvn:com.sun.jersey/jersey-client/1.13
install mvn:com.sun.jersey.contribs.jersey-oauth/oauth-signature/1.13

Then start all these installed bundles.

If you want to uninstall stuff:

bc. uninstall jersey-core
uninstall jersey-client
uninstall jersey-json
uninstall oauth-signature
uninstall oauth-client

h3. Install tumblej and tumblej-camel

1. Build and install *tumblej*

bc. cd ~/git/tumblej
mvn clean install -DskipTests

2. Install the packages into Karaf

bc. install mvn:com.daneshzaki.tumblej/tumblej/2.0.0-SNAPSHOT
install mvn:org.soluvas.social/tumblej-camel/1.0.0-SNAPSHOT

For rapid development:

bc. dev:watch mvn:*


h2. Troubleshooting: com.sun.jersey.api.client.ClientHandlerException: com.sun.jersey.oauth.signature.UnsupportedSignatureMethodException: HMAC-SHA1

I'm not sure why, but uninstalling the Jersey and Jersey-OAuth bundles, then reinstalling (in this order):

* oauth-client
* jersey-core
* jersey-json
* jersey-client
* oauth-signature

then starting these bundles, make it work. Probably something to do with ordering and/or start state of bundles.  

h2. Deploying to ServiceMix (untested)

Get the files:

bc. mvn dependency:copy-dependencies

Needed for ServiceMix:

* jackson-core-asl-1.7.1.jar
* jackson-jaxrs-1.7.1.jar
* jackson-mapper-asl-1.7.1.jar
* jackson-xc-1.7.1.jar
* jersey-client-1.8.jar
* jersey-core-1.8.jar
* jersey-json-1.8.jar
* oauth-client-1.8.jar
* oauth-signature-1.8.jar
* commons-io-2.0.1.jar
* slf4j-api-1.6.1.jar
* slf4j-jcl-1.6.1.jar
* tumblej-*.jar
